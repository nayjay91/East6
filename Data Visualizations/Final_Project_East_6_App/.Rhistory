ggplot(data = q1,aes(x=as.factor(Age), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar(aes(y = ..count../sum(..count..))) + xlab("Age")+scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +ylab("Proportion") +ggtitle("Satisfaction by Age")+ scale_fill_discrete(name = "Satisfaction")+theme(axis.text.x = element_text(angle=45))
ggplot(data = q1,aes(x=as.factor(Age), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar(aes(y = ..count../sum(..count..)), position = 'dodge') + xlab("Age")+scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +ylab("Proportion") +ggtitle("Satisfaction by Age")+ scale_fill_discrete(name = "Satisfaction")+theme(axis.text.x = element_text(angle=45))
ggplot(data = q1,aes(x=as.factor(Age), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar(aes(y = ..count../sum(..count..))) + xlab("Age")+scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +ylab("Proportion") +ggtitle("Satisfaction by Age")+ scale_fill_discrete(name = "Satisfaction")+theme(axis.text.x = element_text(angle=45))
ggplot(data = q1,aes(x=as.factor(Gender), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar(aes(y = ..count../sum(..count..))) + xlab("Gender") +ylab("Proportion")+scale_x_discrete(labels=c("Male","Female")) +ggtitle("Satisfaction by Gender")+ scale_fill_discrete(name = "Satisfaction")
ggplot(data = q1,aes(x=as.factor(Age), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar(aes(y = ..count../sum(..count..))) +
xlab("Age") +
scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +
ylab("Proportion") +
ggtitle("Satisfaction by Age") +
#scale_fill_discrete(name = "Satisfaction") +
scale_fill_gradient(name = "Satisfaction", low = "red", high = "blue")+
theme(axis.text.x = element_text(angle=45))
ggplot(data = q1,aes(x=as.factor(Age), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar(aes(y = ..count../sum(..count..))) +
xlab("Age") +
scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +
ylab("Proportion") +
ggtitle("Satisfaction by Age") +
#scale_fill_discrete(name = "Satisfaction") +
scale_fill_gradient(low = "red", high = "blue")+
theme(axis.text.x = element_text(angle=45))
?scale_fill_discrete()
ggplot(data = q1,aes(x=as.factor(Age), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar(aes(y = ..count../sum(..count..))) +
xlab("Age") +
scale_x_continuous(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +
ylab("Proportion") +
ggtitle("Satisfaction by Age") +
scale_fill_discrete(name = "Satisfaction") +
scale_fill_gradient(low = "red", high = "blue")+
theme(axis.text.x = element_text(angle=45))
ggplot(data = q1,aes(x=as.factor(Age), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar(aes(y = ..count../sum(..count..))) +
xlab("Age") +
scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +
ylab("Proportion") +
ggtitle("Satisfaction by Age") +
scale_fill_discrete(name = "Satisfaction") +
theme(axis.text.x = element_text(angle=45))
ggplot(data = q1,aes(x=as.factor(Age), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
scale_fill_gradient(low = "red", high = "blue")+
geom_bar(aes(y = ..count../sum(..count..))) +
xlab("Age") +
scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +
ylab("Proportion") +
ggtitle("Satisfaction by Age") +
scale_fill_discrete(name = "Satisfaction") +
theme(axis.text.x = element_text(angle=45))
ggplot(data = q1,aes(x=as.factor(Age), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
scale_fill_gradient(low = "red", high = "blue")+
geom_bar(aes(y = ..count../sum(..count..))) +
xlab("Age") +
scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +
ylab("Proportion") +
ggtitle("Satisfaction by Age") +
#scale_fill_discrete(name = "Satisfaction") +
theme(axis.text.x = element_text(angle=45))
ggplot(data = q1,aes(x=as.factor(Age), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar(aes(y = ..count../sum(..count..))) +
xlab("Age") +
scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +
ylab("Proportion") +
ggtitle("Satisfaction by Age") +
scale_fill_discrete(name = "Satisfaction") +
theme(axis.text.x = element_text(angle=45))
ggplot(data = q1,aes(x=as.factor(Age), y = ..count../sum(..count..), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar() +
xlab("Age") +
scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +
ylab("Proportion") +
ggtitle("Satisfaction by Age") +
scale_fill_discrete(name = "Satisfaction") +
theme(axis.text.x = element_text(angle=45))
ggplot(data = q1,aes(x=as.factor(Age), y = ..count../sum(..count..), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar() + #aes(y = ..count../sum(..count..))
xlab("Age") +
scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +
ylab("Proportion") +
ggtitle("Satisfaction by Age") +
scale_fill_discrete(name = "Satisfaction") +
scale_fill_gradient(low = 'red', high = 'blue')
ggplot(data = q1,aes(x=as.factor(Age), y = ..count../sum(..count..), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar() + #aes(y = ..count../sum(..count..))
xlab("Age") +
scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +
ylab("Proportion") +
ggtitle("Satisfaction by Age") +
scale_fill_discrete(name = "Satisfaction") +
scale_x_gradient(low = 'red', high = 'blue')
ggplot(data = q1,aes(x=as.factor(Age), y = ..count../sum(..count..), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar() + #aes(y = ..count../sum(..count..))
xlab("Age") +
scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +
ylab("Proportion") +
ggtitle("Satisfaction by Age") +
scale_fill_discrete(name = "Satisfaction") +
scale_color_gradient(low = 'red', high = 'blue')
ggplot(data = q1,aes(x=as.factor(Age), y = ..count../sum(..count..), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar() +
xlab("Age") +
scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +
ylab("Proportion") +
ggtitle("Satisfaction by Age") +
scale_fill_discrete(name = "Satisfaction") +
theme(axis.text.x = element_text(angle=45))
ggplot(data = q1,aes(x=as.factor(Income_code), fill = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar(aes(y = ..count../sum(..count..))) + xlab("Income") +ylab("Proportion")+scale_x_discrete(labels = c("Under $50k","$50k-$100k","$100k-$150k","Over 150k","Other")) +ggtitle("Satisfaction by Income")+ scale_fill_discrete(name = "Satisfaction")
ggplot(data = q1,aes(x = ..count../sum(..count..), y = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar() +
facet_grid(~as.factor(Age))
ggplot(data = q1,aes(x = ..count../sum(..count..), y = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar() +
coord_flip() +
facet_grid(~as.factor(Age))
ggplot(data = q1,aes(x = ..count../sum(..count..), y = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar() +
coord_flip() +
facet_grid(~as.factor(Age)) +
xlab("Age") +
scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused")) +
ylab("Proportion") +
ggtitle("Satisfaction by Age") +
scale_fill_discrete(name = "Satisfaction") +
theme(axis.text.x = element_text(angle=45))
ggplot(data = q1,aes(x = ..count../sum(..count..), y = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar() +
coord_flip() +
facet_grid(~as.factor(Age)) +
xlab("Age") +
scale_x_discrete(labels=c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused"))
ggplot(data = q1,aes(x = ..count../sum(..count..), y = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar() +
coord_flip() +
facet_grid(~as.factor(Age)) +
xlab("Age")
ggplot(data = q1,aes(x = ..count../sum(..count..), y = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar() +
coord_flip() +
facet_wrap(~as.factor(Age))
ggplot(data = q1,aes(x = ..count../sum(..count..), y = as.factor(CFO_Airport_as_a_whole_0_6))) +
geom_bar() +
coord_flip() +
facet_wrap(~as.factor(Age), labeller = c("Under 18","18-24","25-34","35-44","45-54","55-64","65 and older","Don't know/refused"))
library(factoextra)
library(cluster)
library(mclust)
library(tidyverse)
library(NbClust)
library(lavaan)
q1 %>%
scale() %>%
na.omit() %>%
fviz_nbclust(x = ., FUNcluster = kmeans, method = "gap")
kmeansTest <-  kmeans(x = scale(na.omit(q1)), centers = 4)
fviz_cluster(kmeansTest, scale(na.omit(q1)))
fviz_cluster(kmeansTest, scale(na.omit(q1)), geom = "point")
usedData <-  q1 %>%
na.omit() %>%
scale()
kmeansCenters <- as.data.frame(kmeansTest$centers)
varNames <-  names(kmeansCenters)
unscaleCenters <-  function(varName) {
unscaled = kmeansCenters[, varName] *
attr(x = usedData, which = "scaled:scale")[varName] +
attr(x = usedData, which = "scaled:center")[varName]
res = data.frame(unscaled)
names(res) = varName
return(res)
}
clusterCentersRaw <-  lapply(varNames, function(x) unscaleCenters(x)) %>%
bind_cols(.)
clusterCentersRaw %>%
mutate_if(is.numeric, round, digits = 2)
library(psych)
library(lavaan)
library(ggcorrplot)
q2 %>% pivot_longer(cols = ends_with("0_6")) %>%
#na.omit() %>%
mutate(value = ifelse(value == 6, NA, value)) %>%
ggplot(aes(x=as.factor(value))) +
geom_histogram(stat = 'count') +
facet_wrap(~name, nrow = 4) +
xlab('Rating')
cortest.bartlett(q2)
KMO(q2)
psych::fa.parallel(q2)
scree(q2)
x3 <- fa(r = q2, nfactors = 3, rotate = "promax")
x3
dat_loads <- x3$loadings
dat_loads
scores <- factor.scores(q2,x3,method=c("Thurstone"))
summary(scores$scores)
library(tidytext)
library(sentimentr)
library(textdata)
library(wordcloud)
library(wordcloud2)
library(stm)
library(tm)
comments <- q3 %>%
unnest_tokens(word, Q7_text_All)
comments  %>%
inner_join(get_sentiments("nrc")) %>%
count(sentiment, sort = TRUE)
comments %>%
inner_join(get_sentiments("bing")) %>%
count(sentiment, sort = TRUE)
custom_stop_words <- c("General",
"positive",
"negative",
"comments",
"about",
"SFO",
"airport",
"Airlines",
"neg",
"comment")
df_text <- textProcessor(documents = q3$Q7_text_All,
metadata = missing_encoded,
onlycharacter = TRUE,
customstopwords = c(tm::stopwords("SMART"),
tm::stopwords("en"),
custom_stop_words))
df_Prep <-  prepDocuments(documents = df_text$documents,
vocab = df_text$vocab,
meta = df_text$meta)
kTest <- searchK(documents = df_Prep$documents,
vocab = df_Prep$vocab,
K = c(3, 5, 10, 20, 35),
verbose = F,
max.em.its = 200)
plot(kTest)
topics <-  stm(documents = df_Prep$documents,
vocab = df_Prep$vocab,
K = 5, #change this to whatever the plot shows best
verbose = F,
max.em.its = 200)
plot(topics)
labelTopics(topics)
topics <-  stm(documents = df_Prep$documents,
vocab = df_Prep$vocab,
K = 20, #change this to whatever the plot shows best
verbose = F,
max.em.its = 200)
plot(topics)
labelTopics(topics)
missing_encoded %>%
select(Age,
Gender,
Income_code,
Destination_Market,
Destination_Geo_Loc)
missing_encoded %>%
select(Age,
Gender,
Income_code,
Destination_Market,
Destination_Geo_Loc,
Signs_and_directions_inside_SFO_0_6,
Signs_and_directsion_on_roadways_0_6)
part_b <-  missing_encoded %>%
select(Age,
Gender,
Income_code,
Destination_Market,
Destination_Geo_Loc,
Signs_and_directions_inside_SFO_0_6,
Signs_and_directsion_on_roadways_0_6)
unique(part_b$Destination_Market)
unique(part_b$Destination_Geo_Loc)
part_b <-  missing_encoded %>%
select(Age,
Gender,
Income_code,
Destination_Market, # airport size, can probably remove
Destination_Geo_Loc, # destination US region or foreign continent
Signs_and_directions_inside_SFO_0_6,
Signs_and_directsion_on_roadways_0_6)
ggplot(data = part_b, aes(x = Destination_Geo_Loc, y = Signs_and_directions_inside_SFO_0_6)) +
geom_bar()
ggplot(data = part_b, aes(x = Destination_Geo_Loc, y = Signs_and_directions_inside_SFO_0_6)) +
geom_col()
ggplot(data = part_b, aes(x = as.factor(Destination_Geo_Loc), y = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col()
ggplot(data = part_b, aes(x = as.factor(Destination_Geo_Loc), y = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar()
ggplot(data = part_b, aes(x = as.factor(Destination_Geo_Loc), y = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar(stat = 'identity')
ggplot(data = part_b, aes(x = as.factor(Destination_Geo_Loc), group = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar()
ggplot(data = q1,aes(x=as.factor(Destination_Geo_Loc), y = ..count../sum(..count..), fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar()
ggplot(data = part_b, aes(x=as.factor(Destination_Geo_Loc), y = ..count../sum(..count..), fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar()
ggplot(data = part_b, aes(x=as.factor(Destination_Geo_Loc), y = ..count../sum(..count..), fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar(position = 'dodge')
ggplot(data = part_b, aes(x=as.factor(Destination_Geo_Loc), y = ..count../sum(..count..), fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar(position = 'dodge') +
facet_wrap(~Destination_Geo_Loc)
ggplot(data = part_b, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = ..count../sum(..count..), fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar(position = 'dodge') +
facet_wrap(~Destination_Geo_Loc)
levels(part_b$Destination_Geo_Loc)
missing_encoded %>%
select(Age,
Gender,
Income_code,
Destination_Market, # airport size, can probably remove
Destination_Geo_Loc, # destination US region or foreign continent
Signs_and_directions_inside_SFO_0_6,
Signs_and_directsion_on_roadways_0_6) %>%
mutate(Destination_Geo_Loc = as.factor(Destination_Geo_Loc))
part_b <-  missing_encoded %>%
select(Age,
Gender,
Income_code,
Destination_Market, # airport size, can probably remove
Destination_Geo_Loc, # destination US region or foreign continent
Signs_and_directions_inside_SFO_0_6,
Signs_and_directsion_on_roadways_0_6) %>%
mutate(Destination_Geo_Loc = as.factor(Destination_Geo_Loc))
levels(part_b$Destination_Geo_Loc)
ggplot(data = part_b, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = ..count../sum(..count..), fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar(position = 'dodge') +
facet_wrap(~Destination_Geo_Loc)
art_b$Destination_Geo_Loc
part_b$Destination_Geo_Loc
ggplot(data = part_b, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = ..count../sum(..count..), fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .)
levels(part_b$Destination_Geo_Loc) <- c('US-West', 'US-East', 'US-Mid', 'CA/MX', 'C/S Am', 'EUR', 'ME', 'Asia', 'AUS/NZ')
ggplot(data = part_b, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = ..count../sum(..count..), fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .)
ggplot(data = part_b, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar(position = 'dodge')
ggplot(data = part_b, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar(stat = 'identity', position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .)
ggplot(data = part_b, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = as.factor(Signs_and_directions_inside_SFO_0_6), fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar(stat = 'identity', position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .)
ggplot(data = part_b, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_density() +
#geom_bar(stat = 'identity', position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .)
ggplot(data = part_b, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(stat = 'identity', position = 'dodge')
ggplot(data = part_b, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .)
part_b %>%
group_by(Destination_Geo_Loc) %>%
summarise(n_geo)
part_b %>%
group_by(Destination_Geo_Loc) %>%
summarise(n_geo = n())
part_b %>%
group_by(Destination_Geo_Loc) %>%
summarise(n_geo = n()) %>%
left_join(part_b %>%
group_by(Destination_Geo_Loc, Signs_and_directions_inside_SFO_0_6) %>%
summarise(n_sd_inside_sat = n()))
part_b %>%
group_by(Destination_Geo_Loc) %>%
summarise(n_geo = n()) %>%
left_join(part_b %>%
group_by(Destination_Geo_Loc, Signs_and_directions_inside_SFO_0_6) %>%
summarise(n_sd_inside_sat = n())) %>%
mutate(geo_prop = n_sd_inside_sat / n_geo)
part_b %>%
group_by(Destination_Geo_Loc) %>%
summarise(n_geo = n()) %>%
left_join(part_b %>%
group_by(Destination_Geo_Loc, Signs_and_directions_inside_SFO_0_6) %>%
summarise(n_sd_inside_sat = n())) %>%
mutate(geo_prop = (n_sd_inside_sat / n_geo) * 100)
part_b_geo_prop <- part_b %>%
group_by(Destination_Geo_Loc) %>%
summarise(n_geo = n()) %>%
left_join(part_b %>%
group_by(Destination_Geo_Loc, Signs_and_directions_inside_SFO_0_6) %>%
summarise(n_sd_inside_sat = n())) %>%
mutate(geo_prop = (n_sd_inside_sat / n_geo) * 100)
part_b_geo_prop
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_bar(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .)
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .)
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_continuous(name = "Satisfaction")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_gradient(name = "Satisfaction")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_fermenter(name = "Satisfaction")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_identity(name = "Satisfaction")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_ordinal(name = "Satisfaction")
?scale_fill_ordinal
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_ordinal(name = "Satisfaction", na.value = "black")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_ordinal(name = "Satisfaction", na.value = "black") +
theme_classic()
?scale_fill_ordinal
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_ordinal(name = "Satisfaction", options = 'plasma', na.value = "black")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_ordinal(name = "Satisfaction", option = 'plasma', na.value = "black")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_ordinal(name = "Satisfaction", option = 'spectral', na.value = "black")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_ordinal(name = "Satisfaction", option = 'Spectral', na.value = "black")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_ordinal(name = "Satisfaction", option = 'Accent', na.value = "black")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_hue(name = "Satisfaction", option = 'Accent', na.value = "black")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_hue(name = "Satisfaction",na.value = "black")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_brewer(name = "Satisfaction",na.value = "black")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_brewer(name = "Satisfaction",na.value = "gray")
ggplot(data = part_b_geo_prop, aes(x= as.factor(Signs_and_directions_inside_SFO_0_6), y = geo_prop, fill = as.factor(Signs_and_directions_inside_SFO_0_6))) +
geom_col(position = 'dodge') +
facet_wrap(Destination_Geo_Loc ~ .) +
ylab("Proportion (%)") +
xlab("Satisfaction") +
scale_fill_brewer(name = "Satisfaction", palette = 'Spectral', na.value = "gray")
shiny::runApp()
