---
title: "Visualization EDA"
author: "Nathan Miller"
date: "11/30/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, warning=F, message=F}
library(sf)
library(ggmap)
library(leaflet)
library(dplyr)

census <- st_read("Data/2010_CensusData/2010_CensusData.shp") 
abandoned_properties <- st_read("Data/Abandoned_Property_Parcels/Abandoned_Property_Parcels.shp")
city_council_dist <- st_read("Data/City_Council_Districts/City_Council_Districts.shp")
school_boundaries <- st_read("Data/School_Boundaries/School_Boundaries.shp")

contacts_311_df <- read.csv("Data/311_Contact_Management_Cases.csv")

logs_311_df <- read.csv("Data/311_Phone_Call_Log_Mod.csv")

#311 files do not contain geographical information. 

business_licenses_df <- read.csv("Data/Business_Licenses_geocoded.csv")%>% 
  st_as_sf(coords = c("X","Y"))

#business licenses uses x/y instead of lat/lon

parks_df <- read.csv("Data/Parks_Locations_and_Features.csv") %>% 
  st_as_sf(coords = c("Lon","Lat"))

public_facilities_df <- read.csv("Data/Public_Facilities.csv") %>% 
  st_as_sf(coords = c("Lon","Lat"))

street_lights_df <- read.csv("Data/Street_lights.csv") %>% 
  st_as_sf(coords = c("Lon","Lat"))
```

```{r}
pal_park <- colorFactor(palette = 'Set2', domain =plf_df2$Park_Type)
pal_school <- colorFactor(palette = "Set4", domain = dat$SchoolType)


plf_df2$popup <- paste("<b>",plf_df2$Park_Name,"</b><br>",
                                  "Type: ",plf_df2$Park_Type,sep ="")
dat$popup <- paste("<b>",dat$School,"</b><br>",
                                  "Type: ",dat$SchoolType,sep ="")

leaflet()  %>%
  addTiles()  %>%
  addCircleMarkers(data = business_licenses_df, stroke = 0, fillOpacity = 1, radius = 4) 
```

